<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸŒˆ Magic Garden Hatching Guide</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #1a1f2e;
      --bg-card: #252b3d;
      --bg-card-hover: #2d3548;
      --accent-rainbow: linear-gradient(135deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3, #54a0ff);
      --accent-gold: #ffd700;
      --accent-green: #26de81;
      --accent-blue: #45aaf2;
      --accent-purple: #a55eea;
      --accent-pink: #fd79a8;
      --text-primary: #f5f6fa;
      --text-secondary: #a4b0be;
      --border-subtle: rgba(255, 255, 255, 0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Nunito', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 2rem;
      min-height: 100vh;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 2rem;
      background: var(--bg-card);
      border-radius: 20px;
      border: 1px solid var(--border-subtle);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 800;
      background: var(--accent-rainbow);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.5rem;
    }

    .subtitle {
      color: var(--text-secondary);
      font-size: 1.1rem;
    }

    .section {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border: 1px solid var(--border-subtle);
    }

    .section-title {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .section-title .icon {
      font-size: 1.6rem;
    }

    /* Quick Tips */
    .tips-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.75rem;
    }

    .tip-card {
      background: rgba(255, 255, 255, 0.03);
      border-radius: 10px;
      padding: 0.75rem;
      border-left: 3px solid var(--accent-gold);
    }

    .tip-title {
      font-weight: 700;
      font-size: 0.85rem;
      margin-bottom: 0.25rem;
    }

    .tip-desc {
      font-size: 0.8rem;
      color: var(--text-secondary);
      line-height: 1.4;
    }

    /* Batch Size Tabs */
    .batch-tabs {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    .batch-tab {
      padding: 0.6rem 1.2rem;
      border-radius: 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid var(--border-subtle);
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .batch-tab:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .batch-tab.active {
      background: var(--accent-purple);
      border-color: var(--accent-purple);
      box-shadow: 0 4px 12px rgba(165, 94, 234, 0.3);
    }

    /* Custom batch input */
    .custom-batch {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      margin-top: 0.75rem;
      flex-wrap: wrap;
    }

    .custom-batch input {
      padding: 0.5rem;
      border-radius: 8px;
      border: 2px solid var(--border-subtle);
      background: var(--bg-card-hover);
      color: var(--text-primary);
      font-family: 'Nunito', sans-serif;
      width: 120px;
    }

    .custom-batch button {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      border: none;
      background: var(--accent-purple);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .custom-batch button:hover {
      background: #8854d0;
    }

    /* Strategy Card Navigation */
    .strategy-carousel {
      position: relative;
      overflow: hidden;
      min-height: 200px;
    }

    .strategy-track {
      display: flex;
      transition: transform 0.3s ease;
    }

    .strategy-card {
      flex: 0 0 100%;
      background: var(--bg-card-hover);
      border-radius: 12px;
      padding: 1.25rem;
      border: 2px solid transparent;
      margin: 0 0.5rem;
    }

    .strategy-card.recommended::before {
      content: 'â­ BEST';
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: var(--accent-gold);
      color: #000;
      font-size: 0.7rem;
      font-weight: 800;
      padding: 0.25rem 0.5rem;
      border-radius: 8px;
    }

    .strategy-name {
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.75rem;
      color: var(--accent-blue);
    }

    /* Pet Sprite Images */
    .pet-sprite {
      width: 48px;
      height: 48px;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
      object-fit: contain;
    }

    .pet-sprite-small {
      width: 32px;
      height: 32px;
      image-rendering: pixelated;
      object-fit: contain;
    }

    .sprite-placeholder {
      width: 48px;
      height: 48px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }

    .strategy-nav {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 1rem;
      align-items: center;
    }

    .nav-btn {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid var(--border-subtle);
      color: var(--text-primary);
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-btn:hover {
      background: var(--accent-purple);
      border-color: var(--accent-purple);
    }

    .strategy-dots {
      display: flex;
      gap: 0.5rem;
    }

    .dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      cursor: pointer;
      transition: all 0.2s;
    }

    .dot.active {
      background: var(--accent-purple);
      width: 24px;
      border-radius: 4px;
    }

    .pet-team {
      display: flex;
      gap: 0.5rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    .pet-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      background: rgba(255, 255, 255, 0.08);
      padding: 0.35rem 0.6rem;
      border-radius: 20px;
      font-size: 0.85rem;
    }

    .stats-row {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .stat {
      display: flex;
      flex-direction: column;
      gap: 0.1rem;
    }

    .stat-label {
      font-size: 0.7rem;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .stat-value {
      font-weight: 700;
      font-size: 1.1rem;
    }

    .stat-value.rainbow {
      background: var(--accent-rainbow);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stat-value.gold {
      color: var(--accent-gold);
    }

    .stat-value.green {
      color: var(--accent-green);
    }

    .stat-value.blue {
      color: var(--accent-blue);
    }

    /* Team Builder (Improved Layout) */
    .team-builder {
      background: rgba(255, 255, 255, 0.03);
      padding: 1.25rem;
      border-radius: 12px;
      margin-top: 1rem;
    }

    .pet-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .pet-option {
      padding: 0.75rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 10px;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.2s;
      text-align: center;
      position: relative;
    }

    .pet-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .pet-option.selected {
      border-color: var(--accent-purple);
      background: rgba(165, 94, 234, 0.2);
    }

    .pet-count {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      background: var(--accent-purple);
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      font-size: 0.75rem;
      font-weight: 700;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .pet-option.selected .pet-count {
      display: flex;
    }

    .pet-emoji {
      font-size: 2rem;
      margin-bottom: 0.25rem;
    }

    .pet-name {
      font-size: 0.8rem;
      font-weight: 600;
    }

    .selected-team {
      background: var(--bg-card-hover);
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 1rem;
      min-height: 60px;
    }

    .selected-team-title {
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .selected-pets {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .result-box {
      background: var(--bg-card-hover);
      padding: 1rem;
      border-radius: 8px;
    }

    /* Probability Table */
    .compare-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    .compare-table th {
      text-align: left;
      padding: 0.75rem;
      border-bottom: 2px solid var(--border-subtle);
      color: var(--text-secondary);
      font-weight: 600;
      font-size: 0.8rem;
      text-transform: uppercase;
    }

    .compare-table td {
      padding: 0.75rem;
      border-bottom: 1px solid var(--border-subtle);
    }

    .compare-table tr:hover td {
      background: rgba(255, 255, 255, 0.02);
    }

    .highlight {
      color: var(--accent-gold);
      font-weight: 700;
    }

    .batch-section {
      display: none;
    }

    .batch-section.active {
      display: block;
    }

    footer {
      text-align: center;
      padding: 2rem;
      color: var(--text-secondary);
      font-size: 0.85rem;
    }

    @media (max-width: 600px) {
      body {
        padding: 1rem;
      }

      h1 {
        font-size: 1.8rem;
      }

      .pet-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <h1>ğŸŒˆ Rainbow Hatching Guide</h1>
      <p class="subtitle">Comprehensive pet hatching optimization for Magic Garden</p>
    </header>

    <!-- Quick Reference -->
    <section class="section">
      <h2 class="section-title"><span class="icon">âš¡</span> Quick Reference</h2>
      <div class="tips-grid">
        <div class="tip-card">
          <div class="tip-title">ğŸŒˆ Base Rainbow</div>
          <div class="tip-desc">0.1% per hatch</div>
        </div>
        <div class="tip-card">
          <div class="tip-title">ğŸ¿ï¸ Squirrel Boost</div>
          <div class="tip-desc">+10% each (stacks)</div>
        </div>
        <div class="tip-card">
          <div class="tip-title">ğŸ Goat STR</div>
          <div class="tip-desc">14% â†’ +3.5% max</div>
        </div>
        <div class="tip-card">
          <div class="tip-title">ğŸ¦ƒ Double Hatch</div>
          <div class="tip-desc">3% â†’ 2 independent rolls</div>
        </div>
      </div>
    </section>

    <!-- Batch Size Selector -->
    <section class="section">
      <h2 class="section-title"><span class="icon">ğŸ¯</span> Select Your Batch Size</h2>
      <div class="batch-tabs">
        <div class="batch-tab active" data-batch="small">ğŸ’ Small (1-25)</div>
        <div class="batch-tab" data-batch="medium">ğŸ“¦ Medium (50-300)</div>
        <div class="batch-tab" data-batch="large">ğŸ­ Large (500+)</div>
      </div>

      <div class="custom-batch">
        <label style="color: var(--text-secondary); font-size: 0.9rem;">Custom:</label>
        <input type="number" id="customBatchSize" placeholder="Enter count" min="1">
        <button onclick="applyCustomBatch()">Calculate</button>
        <span id="customResult" style="color: var(--text-secondary); font-size: 0.85rem; margin-left: 0.5rem;"></span>
      </div>

      <!-- SMALL BATCH STRATEGIES -->
      <div class="batch-section active" data-batch-section="small">
        <h3 style="color: var(--accent-purple); margin: 1.5rem 0 1rem; font-size: 1.1rem;">
          ğŸ’ Small Batch (1-25 Eggs)
        </h3>
        <div class="strategy-carousel">
          <div class="strategy-track" id="smallTrack">
            <!-- Strategy 1 -->
            <div class="strategy-card recommended">
              <div class="strategy-name">Pure Rainbow (Best Rate)</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸ Squirrel Ã—3</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/25</span>
                  <span class="stat-value rainbow">3.25%</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Rate</span>
                  <span class="stat-value">0.130%</span>
                </div>
              </div>
            </div>

            <!-- Strategy 2 -->
            <div class="strategy-card">
              <div class="strategy-name">Balanced Rainbow + STR</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ Goat</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/25</span>
                  <span class="stat-value rainbow">3.00%</span>
                </div>
                <div class="stat">
                  <span class="stat-label">STR Boost</span>
                  <span class="stat-value green">14%</span>
                </div>
              </div>
            </div>

            <!-- Strategy 3 -->
            <div class="strategy-card">
              <div class="strategy-name">Rainbow + STR + Bonus Pets</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸ Squirrel + ğŸ Goat + ğŸ¦ƒ Turkey</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/25</span>
                  <span class="stat-value rainbow">2.83%</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Bonus Pets</span>
                  <span class="stat-value blue">+3%</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                Double Hatch gives 2 independent rainbow rolls when it procs
              </p>
            </div>

            <!-- Strategy 4 -->
            <div class="strategy-card">
              <div class="strategy-name">Double Hatch Focus</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ¦ƒ Turkey</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/25</span>
                  <span class="stat-value rainbow">3.09%</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Rate</span>
                  <span class="stat-value">0.120%/hatch</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                3% chance â†’ 2 pets each with 0.12% rainbow = effective 0.124%/egg
              </p>
            </div>
          </div>
        </div>
        <div class="strategy-nav">
          <button class="nav-btn" onclick="changeStrategy('small', -1)">â—€</button>
          <div class="strategy-dots" id="smallDots"></div>
          <button class="nav-btn" onclick="changeStrategy('small', 1)">â–¶</button>
        </div>
      </div>

      <!-- MEDIUM BATCH STRATEGIES -->
      <div class="batch-section" data-batch-section="medium">
        <h3 style="color: var(--accent-blue); margin: 1.5rem 0 1rem; font-size: 1.1rem;">
          ğŸ“¦ Medium Batch (50-300 Eggs)
        </h3>
        <div class="strategy-carousel">
          <div class="strategy-track" id="mediumTrack">
            <!-- Strategy 1 -->
            <div class="strategy-card recommended">
              <div class="strategy-name">Hatch & Recycle (Best Efficiency)</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ (hatch)</span>
              </div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ”Ã—3 â†’ ğŸ¦šÃ—3 (sell)</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/100</span>
                  <span class="stat-value rainbow">0.13-0.14</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Refund</span>
                  <span class="stat-value gold">15-20%</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                Start with Chickens (5% refund), upgrade to Peacocks (7%) as you get them
              </p>
            </div>

            <!-- Strategy 2 -->
            <div class="strategy-card">
              <div class="strategy-name">Double Hatch + Recycle Combo</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸ + ğŸ + ğŸ¦ƒ (hatch)</span>
              </div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ”Ã—3 â†’ ğŸ¦šÃ—3 (sell)</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/100</span>
                  <span class="stat-value rainbow">0.11-0.12</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Extra Pets</span>
                  <span class="stat-value blue">+3%</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                When Double Hatch procs: 2 pets with independent rainbow chances + get egg back if no rainbow
              </p>
            </div>

            <!-- Strategy 3 -->
            <div class="strategy-card">
              <div class="strategy-name">Pure Volume (No Swapping)</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—3</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Rainbow/100</span>
                  <span class="stat-value rainbow">0.13</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                Simpler strategy - no pet swapping required
              </p>
            </div>
          </div>
        </div>
        <div class="strategy-nav">
          <button class="nav-btn" onclick="changeStrategy('medium', -1)">â—€</button>
          <div class="strategy-dots" id="mediumDots"></div>
          <button class="nav-btn" onclick="changeStrategy('medium', 1)">â–¶</button>
        </div>
      </div>

      <!-- LARGE BATCH STRATEGIES -->
      <div class="batch-section" data-batch-section="large">
        <h3 style="color: var(--accent-green); margin: 1.5rem 0 1rem; font-size: 1.1rem;">
          ğŸ­ Large Batch (500+ Eggs)
        </h3>
        <div class="strategy-carousel">
          <div class="strategy-track" id="largeTrack">
            <!-- Strategy 1 -->
            <div class="strategy-card recommended">
              <div class="strategy-name">Volume Farming (Best Rate)</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸ Squirrel Ã—3</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Per 1000</span>
                  <span class="stat-value rainbow">1.30</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Rate</span>
                  <span class="stat-value">0.130%</span>
                </div>
              </div>
            </div>

            <!-- Strategy 2 -->
            <div class="strategy-card">
              <div class="strategy-name">With Egg Recycling</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—3 (hatch)</span>
              </div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¦šÃ—3 (sell)</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Effective</span>
                  <span class="stat-value rainbow">0.138%</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Refund</span>
                  <span class="stat-value gold">~7-20%</span>
                </div>
              </div>
            </div>

            <!-- Strategy 3 -->
            <div class="strategy-card">
              <div class="strategy-name">Double Hatch Volume</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ¦ƒ Turkey</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Per 1000</span>
                  <span class="stat-value rainbow">1.24</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Pets</span>
                  <span class="stat-value blue">1030</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                Each Double Hatch = 2 independent rainbow rolls at 0.12% each
              </p>
            </div>

            <!-- Strategy 4 -->
            <div class="strategy-card">
              <div class="strategy-name">Triple Turkey (Max Pets)</div>
              <div class="pet-team">
                <span class="pet-badge">ğŸ¦ƒ Turkey Ã—3</span>
              </div>
              <div class="stats-row">
                <div class="stat">
                  <span class="stat-label">Per 1000</span>
                  <span class="stat-value rainbow">1.06</span>
                </div>
                <div class="stat">
                  <span class="stat-label">Pets</span>
                  <span class="stat-value blue">1090</span>
                </div>
              </div>
              <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.5rem;">
                For journal completion only - lower rainbow rate but max pet volume
              </p>
            </div>
          </div>
        </div>
        <div class="strategy-nav">
          <button class="nav-btn" onclick="changeStrategy('large', -1)">â—€</button>
          <div class="strategy-dots" id="largeDots"></div>
          <button class="nav-btn" onclick="changeStrategy('large', 1)">â–¶</button>
        </div>
      </div>
    </section>

    <!-- Team Builder -->
    <section class="section">
      <h2 class="section-title"><span class="icon">ğŸ”§</span> Team Builder</h2>
      <p style="color: var(--text-secondary); margin-bottom: 1rem; font-size: 0.9rem;">
        Build your team (up to 3 pets, can select multiples of same pet)
      </p>
      <div class="team-builder">
        <div class="selected-team">
          <div class="selected-team-title">Your Team:</div>
          <div class="selected-pets" id="selectedPets">
            <span style="color: var(--text-secondary); font-size: 0.85rem;">Click pets below to add them</span>
          </div>
        </div>

        <div class="pet-grid" id="petGrid">
          <!-- Will be populated by JS -->
        </div>

        <div class="result-box" id="teamResult">
          <strong>Select pets to see rainbow chance</strong>
        </div>
      </div>
    </section>

    <!-- Probability Table -->
    <section class="section">
      <h2 class="section-title"><span class="icon">ğŸ“Š</span> Expected Rainbows</h2>
      <table class="compare-table">
        <thead>
          <tr>
            <th>Team</th>
            <th>100</th>
            <th>500</th>
            <th>1000</th>
            <th>5000</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="pet-badge">ğŸ¿ï¸Ã—3</span></td>
            <td class="highlight">0.13</td>
            <td class="highlight">0.65</td>
            <td class="highlight">1.30</td>
            <td class="highlight">6.50</td>
          </tr>
          <tr>
            <td><span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ</span></td>
            <td>0.12</td>
            <td>0.60</td>
            <td>1.20</td>
            <td>6.00</td>
          </tr>
          <tr>
            <td><span class="pet-badge">ğŸ¿ï¸Ã—2 + ğŸ¦ƒ</span></td>
            <td>0.12<small class="font-size: 0.75rem; color: var(--text-secondary);">+3 pets</small></td>
            <td>0.62</td>
            <td>1.24</td>
            <td>6.18</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Advanced Tips -->
    <section class="section">
      <h2 class="section-title"><span class="icon">ğŸ”¬</span> Advanced Tips</h2>
      <div class="tips-grid">
        <div class="tip-card" style="border-color: var(--accent-blue);">
          <div class="tip-title">ğŸ² Ability Rolls</div>
          <div class="tip-desc">70% get 1 ability, 29% get 2, only 1% get all 3!</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-pink);">
          <div class="tip-title">ğŸ¦ƒ Turkey Rarity</div>
          <div class="tip-desc">Only 5% weight for Double Hatch ability. ~3.5% to get it.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-purple);">
          <div class="tip-title">ğŸ¿ï¸ Squirrel Hunt</div>
          <div class="tip-desc">10% weight = ~7% chance to get Pet Mutation Boost II.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-green);">
          <div class="tip-title">ğŸ Goat Odds</div>
          <div class="tip-desc">10% weight = ~7% to get Max STR Boost II when hatched.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-gold);">
          <div class="tip-title">ğŸ’° Sell Value</div>
          <div class="tip-desc">Rainbow pets sell for 50Ã— base, Gold for 25Ã—.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-rainbow);">
          <div class="tip-title">ğŸ“ˆ STR 100</div>
          <div class="tip-desc">Abilities scale with STR. Always train to 100 before using.</div>
        </div>
      </div>
    </section>

    <!-- Pro Tips -->
    <section class="section">
      <h2 class="section-title"><span class="icon">ğŸ’¡</span> Pro Tips</h2>
      <div class="tips-grid">
        <div class="tip-card" style="border-color: var(--accent-rainbow);">
          <div class="tip-title">ğŸŒˆ Rainbow</div>
          <div class="tip-desc">3Ã— Squirrel = best rate. Don't split slots.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-green);">
          <div class="tip-title">â™»ï¸ Refund</div>
          <div class="tip-desc">Start with Chickens (5%), upgrade to Peacocks (7%).</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-blue);">
          <div class="tip-title">ğŸ¦ƒ Double Hatch</div>
          <div class="tip-desc">Each proc = 2 independent rainbow rolls. Combine with refund.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-purple);">
          <div class="tip-title">ğŸ’ª 2Ã— Goat</div>
          <div class="tip-desc">Both can proc on same pet (26% chance, 2% for both).</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-pink);">
          <div class="tip-title">ğŸ”„ Refund + Double</div>
          <div class="tip-desc">Get egg back â†’ try for double hatch again.</div>
        </div>
        <div class="tip-card" style="border-color: var(--accent-gold);">
          <div class="tip-title">ğŸ“ˆ Effective Rate</div>
          <div class="tip-desc">Double Hatch increases per-egg rate, not just pet count.</div>
        </div>
      </div>
    </section>

    <footer>
      <p>Data verified from Magic Garden source files & wiki</p>
      <p style="margin-top: 0.5rem; font-size: 0.75rem; opacity: 0.7;">Last updated: January 2026</p>
    </footer>
  </div>

  <script>
    // Sprite URLs from production Magic Garden
    const SPRITE_BASE = 'https://magicgarden.gg/assets';
    const SPRITE_MAPPINGS = {
      'Squirrel': `${SPRITE_BASE}/pets/squirrel.png`,
      'Dragonfly': `${SPRITE_BASE}/pets/dragonfly.png`,
      'Goat': `${SPRITE_BASE}/pets/goat.png`,
      'Pig': `${SPRITE_BASE}/pets/pig.png`,
      'Turkey': `${SPRITE_BASE}/pets/turkey.png`,
      'Chicken': `${SPRITE_BASE}/pets/chicken.png`,
      'Peacock': `${SPRITE_BASE}/pets/peacock.png`
    };

    // Pet data with emoji fallbacks
    const pets = [
      { name: 'Squirrel', emoji: 'ğŸ¿ï¸', boost: 10, sprite: SPRITE_MAPPINGS.Squirrel },
      { name: 'Dragonfly', emoji: 'ğŸª°', boost: 7, sprite: SPRITE_MAPPINGS.Dragonfly },
      { name: 'Goat', emoji: 'ğŸ', boost: 0, str: 14, sprite: SPRITE_MAPPINGS.Goat },
      { name: 'Pig', emoji: 'ğŸ·', boost: 0, str: 12, sprite: SPRITE_MAPPINGS.Pig },
      { name: 'Turkey', emoji: 'ğŸ¦ƒ', boost: 0, double: 3, sprite: SPRITE_MAPPINGS.Turkey },
      { name: 'Chicken', emoji: 'ğŸ”', boost: 0, refund: 5, sprite: SPRITE_MAPPINGS.Chicken },
      { name: 'Peacock', emoji: 'ğŸ¦š', boost: 0, refund: 7, sprite: SPRITE_MAPPINGS.Peacock }
    ];

    // Team builder state
    let selectedPets = [];

    // Strategy carousel state
    const carouselState = {
      small: 0,
      medium: 0,
      large: 0
    };

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      initBatchTabs();
      initPetGrid();
      initCarousels();
    });

    // Batch tabs
    function initBatchTabs() {
      const tabs = document.querySelectorAll('.batch-tab');
      const sections = document.querySelectorAll('.batch-section');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const batch = tab.dataset.batch;

          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');

          sections.forEach(s => {
            s.classList.remove('active');
            if (s.dataset.batchSection === batch) {
              s.classList.add('active');
            }
          });
        });
      });
    }

    // Custom batch calculator
    function applyCustomBatch() {
      const input = document.getElementById('customBatchSize');
      const result = document.getElementById('customResult');
      const count = parseInt(input.value);

      if (!count || count < 1) {
        result.textContent = 'Please enter a valid number';
        return;
      }

      // Calculate with 3Ã— Squirrel (0.13% rainbow, 1.3% gold)
      const rainbows = (count * 0.0013).toFixed(2);
      const golds = (count * 0.013).toFixed(2);
      result.innerHTML = `Expected: <span style="color: var(--accent-rainbow);">${rainbows} rainbows</span>, <span style="color: var(--accent-gold);">${golds} golds</span>`;
    }

    // Strategy carousels
    function initCarousels() {
      ['small', 'medium', 'large'].forEach(batch => {
        const track = document.getElementById(`${batch}Track`);
        const dots = document.getElementById(`${batch}Dots`);
        const cards = track.children.length;

        // Create dots
        for (let i = 0; i < cards; i++) {
          const dot = document.createElement('div');
          dot.className = `dot ${i === 0 ? 'active' : ''}`;
          dot.onclick = () => goToStrategy(batch, i);
          dots.appendChild(dot);
        }
      });
    }

    function changeStrategy(batch, direction) {
      const track = document.getElementById(`${batch}Track`);
      const cards = track.children.length;

      carouselState[batch] = (carouselState[batch] + direction + cards) % cards;
      updateCarousel(batch);
    }

    function goToStrategy(batch, index) {
      carouselState[batch] = index;
      updateCarousel(batch);
    }

    function updateCarousel(batch) {
      const track = document.getElementById(`${batch}Track`);
      const dots = document.getElementById(`${batch}Dots`).children;
      const index = carouselState[batch];

      track.style.transform = `translateX(-${index * 100}%)`;

      Array.from(dots).forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
    }

    // Pet grid with sprite support
    function initPetGrid() {
      const grid = document.getElementById('petGrid');

      pets.forEach(pet => {
        const option = document.createElement('div');
        option.className = 'pet-option';

        // Try to load sprite, fallback to emoji
        const spriteHTML = `
          <img 
            class="pet-sprite" 
            src="${pet.sprite}" 
            alt="${pet.name}"
            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
            style="margin-bottom: 0.25rem;"
          />
          <div class="pet-emoji" style="display: none;">${pet.emoji}</div>
        `;

        option.innerHTML = `
          <div class="pet-count">0</div>
          ${spriteHTML}
          <div class="pet-name">${pet.name}</div>
        `;
        option.onclick = () => togglePet(pet, option);
        grid.appendChild(option);
      });
    }

    // FIXED: Allow multiple of same pet
    function togglePet(pet, element) {
      const currentTotal = selectedPets.length;
      const petCount = selectedPets.filter(p => p.name === pet.name).length;

      if (currentTotal < 3) {
        // Always add if there's room
        selectedPets.push(pet);
      } else {
        // If team is full and we click a pet that's in the team, remove one instance
        const index = selectedPets.findIndex(p => p.name === pet.name);
        if (index !== -1) {
          selectedPets.splice(index, 1);
        }
      }

      // Update element classes and count
      const newPetCount = selectedPets.filter(p => p.name === pet.name).length;
      element.classList.toggle('selected', newPetCount > 0);
      const countEl = element.querySelector('.pet-count');
      countEl.textContent = newPetCount;
      countEl.style.display = newPetCount > 0 ? 'flex' : 'none';

      updateTeamDisplay();
      updateTeamResult();
    }

    function updateTeamDisplay() {
      const display = document.getElementById('selectedPets');

      if (selectedPets.length === 0) {
        display.innerHTML = '<span style="color: var(--text-secondary); font-size: 0.85rem;">Click pets below to add them</span>';
        return;
      }

      // Count pets
      const petCounts = {};
      selectedPets.forEach(p => {
        petCounts[p.name] = (petCounts[p.name] || 0) + 1;
      });

      display.innerHTML = Object.entries(petCounts)
        .map(([name, count]) => {
          const pet = pets.find(p => p.name === name);
          return `<span class="pet-badge">${pet.emoji} ${pet.name}${count > 1 ? ' Ã—' + count : ''}</span>`;
        })
        .join('');
    }

    function updateTeamResult() {
      const result = document.getElementById('teamResult');

      if (selectedPets.length === 0) {
        result.innerHTML = '<strong>Select pets to see rainbow chance</strong>';
        return;
      }

      // Calculate total boost
      const totalBoost = selectedPets.reduce((sum, pet) => sum + (pet.boost || 0), 0);
      const rainbowRate = 0.1 * (1 + totalBoost / 100);
      const goldRate = 1.0 * (1 + totalBoost / 100);

      // Check for Double Hatch
      const hasDouble = selectedPets.some(p => p.double);
      const doubleRate = hasDouble ? 0.03 : 0;

      // Effective rates (per egg accounting for Double Hatch)
      let effectiveRainbow = rainbowRate;
      let effectiveGold = goldRate;

      if (hasDouble) {
        // When Double Hatch procs: 2 independent rolls
        const doubleRainbowChance = 1 - Math.pow(1 - rainbowRate / 100, 2);
        const doubleGoldChance = 1 - Math.pow(1 - goldRate / 100, 2);

        // Weighted average: 97% normal, 3% double
        effectiveRainbow = (0.97 * rainbowRate + 0.03 * doubleRainbowChance * 100);
        effectiveGold = (0.97 * goldRate + 0.03 * doubleGoldChance * 100);
      }

      // Check for special abilities
      const hasStr = selectedPets.some(p => p.str);
      const hasRefund = selectedPets.some(p => p.refund);

      let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem;">';

      // Per-Hatch Rates
      html += '<div style="grid-column: 1 / -1; font-weight: 700; margin-bottom: 0.5rem; font-size: 0.9rem;">Per-Hatch Rates:</div>';
      html += `<div><strong>Rainbow:</strong> <span style="background: var(--accent-rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${rainbowRate.toFixed(3)}%</span></div>`;
      html += `<div><strong>Gold:</strong> <span style="color: var(--accent-gold)">${goldRate.toFixed(2)}%</span></div>`;

      if (hasDouble) {
        html += '<div style="grid-column: 1 / -1; font-weight: 700; margin: 0.75rem 0 0.5rem; font-size: 0.9rem;">Effective (Per Egg) Rates:</div>';
        html += `<div><strong>Rainbow:</strong> <span style="background: var(--accent-rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${effectiveRainbow.toFixed(3)}%</span></div>`;
        html += `<div><strong>Gold:</strong> <span style="color: var(--accent-gold)">${effectiveGold.toFixed(2)}%</span></div>`;
      }

      // Batch rates with full recycling loop
      const refundPets = selectedPets.filter(p => p.refund);
      const avgRefundRate = refundPets.length > 0
        ? refundPets.reduce((sum, p) => sum + p.refund, 0) / 100
        : 0;

      // Calculate total eggs hatched with recycling
      // Formula: eggs / (1 - refundRate) for non-rainbow pets
      const recycledEggs = avgRefundRate > 0 ? 100 / (1 - avgRefundRate * 0.97) : 100;
      const totalHatches = recycledEggs * (hasDouble ? 1.03 : 1);

      html += '<div style="grid-column: 1 / -1; font-weight: 700; margin: 0.75rem 0 0.5rem; font-size: 0.9rem;">Expected per 100 Eggs';
      if (avgRefundRate > 0 || hasDouble) {
        html += ' <span style="font-size: 0.75rem; color: var(--text-secondary);">(with recycling)</span>';
      }
      html += ':</div>';
      html += `<div><strong>Rainbows:</strong> <span style="background: var(--accent-rainbow); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">${(totalHatches * effectiveRainbow / 100).toFixed(2)}</span></div>`;
      html += `<div><strong>Golds:</strong> <span style="color: var(--accent-gold)">${(totalHatches * effectiveGold / 100).toFixed(2)}</span></div>`;
      if (totalHatches > 100) {
        html += `<div style="grid-column: 1 / -1; font-size: 0.75rem; color: var(--text-secondary); margin-top: 0.25rem;">~${totalHatches.toFixed(0)} total hatches from recycling</div>`;
      }

      if (hasStr || hasRefund) {
        html += '<div style="grid-column: 1 / -1; margin-top: 0.75rem; font-size: 0.85rem; color: var(--text-secondary);"><strong>Bonuses:</strong> ';
        const bonuses = [];
        if (hasStr) bonuses.push('Max STR Boost');
        if (hasDouble) bonuses.push('Double Hatch (2 rolls/proc)');
        if (hasRefund) bonuses.push('Egg Refund');
        html += bonuses.join(', ');
        html += '</div>';
      }

      html += '</div>';

      result.innerHTML = html;
    }
  </script>
</body>

</html>
```